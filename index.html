<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lumiart CRM ‚Äî Online (Supabase) v2</title>
  <link rel="stylesheet" href="./styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  <header class="topbar">
    <div class="brand">‚öôÔ∏è Lumiart CRM <span class="muted">online v2</span></div>
    <div class="topbar-right">
      <div id="userBadge" class="badge hidden"></div>
      <button id="logoutBtn" class="btn btn-ghost hidden">–í—ã–π—Ç–∏</button>
    </div>
  </header>

  <main class="container">
    <!-- Auth -->
    <section id="authView" class="card">
      <h2>–í—Ö–æ–¥</h2>
      <p class="muted">–û–Ω–ª–∞–π–Ω CRM: —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∞–π—Ç + Supabase (–ë–î + –ª–æ–≥–∏–Ω—ã + RLS). –ù—É–∂–Ω—ã URL + Anon Key –≤ <span class="mono">app.js</span>.</p>

      <div class="grid2">
        <div>
          <h3>–í–æ–π—Ç–∏</h3>
          <form id="loginForm" class="form">
            <label>Email</label>
            <input name="email" type="email" placeholder="you@company.com" required />
            <label>–ü–∞—Ä–æ–ª—å</label>
            <input name="password" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required />
            <button class="btn btn-primary" type="submit">–í–æ–π—Ç–∏</button>
            <div id="loginMsg" class="msg"></div>
          </form>
        </div>

        <div>
          <h3>–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
          <form id="signupForm" class="form">
            <label>Email</label>
            <input name="email" type="email" placeholder="new@company.com" required />
            <label>–ü–∞—Ä–æ–ª—å</label>
            <input name="password" type="password" placeholder="–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤" minlength="6" required />
            <button class="btn" type="submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
            <div class="muted small">‚ö†Ô∏è –í Supabase Auth –≤–∫–ª—é—á–∏ Email/Password.</div>
            <div id="signupMsg" class="msg"></div>
          </form>
        </div>
      </div>
    </section>

    <!-- App -->
    <section id="appView" class="hidden">
      <section class="card">
        <div class="row">
          <div>
            <h2 style="margin:0">–î–∞—à–±–æ—Ä–¥</h2>
            <div class="muted small">–ë—ã—Å—Ç—Ä—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Ä–µ–∑–µ—Ä–≤–∞</div>
          </div>
          <button class="btn" id="refreshAll">–û–±–Ω–æ–≤–∏—Ç—å –≤—Å—ë</button>
        </div>
        <div class="kpis" id="kpis"></div>
        <div class="muted small" id="conflictsNote" style="margin-top:10px"></div>
      </section>

      <nav class="tabs">
        <button class="tab active" data-tab="leads">–õ–∏–¥—ã</button>
        <button class="tab" data-tab="projects">–ü—Ä–æ–µ–∫—Ç—ã</button>
        <button class="tab" data-tab="reservations">–†–µ–∑–µ—Ä–≤—ã</button>
        <button class="tab" data-tab="equipment">–°–∫–ª–∞–¥</button>
        <button class="tab" data-tab="tasks">–ó–∞–¥–∞—á–∏</button>
      </nav>

      <!-- Leads -->
      <section class="card tabpane" id="tab-leads">
        <div class="row">
          <h2>–õ–∏–¥—ã</h2>
          <button class="btn btn-primary" id="leadNewBtn">+ –õ–∏–¥</button>
        </div>
        <div class="filters">
          <input id="leadSearch" placeholder="–ü–æ–∏—Å–∫: –Ω–∞–∑–≤–∞–Ω–∏–µ / –∏—Å—Ç–æ—á–Ω–∏–∫ / –≥–æ—Ä–æ–¥" />
          <select id="leadStatus">
            <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
          </select>
          <button class="btn" id="leadRefresh">–û–±–Ω–æ–≤–∏—Ç—å</button>
        </div>
        <div class="tablewrap">
          <table class="table" id="leadsTable">
            <thead>
              <tr>
                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–°—Ç–∞—Ç—É—Å</th><th>–ò—Å—Ç–æ—á–Ω–∏–∫</th><th>–î–∞—Ç–∞</th><th>–ì–æ—Ä–æ–¥</th><th class="right">‚Äî</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- Projects -->
      <section class="card tabpane hidden" id="tab-projects">
        <div class="row">
          <h2>–ü—Ä–æ–µ–∫—Ç—ã</h2>
          <button class="btn btn-primary" id="projectNewBtn">+ –ü—Ä–æ–µ–∫—Ç</button>
        </div>
        <div class="filters">
          <input id="projectSearch" placeholder="–ü–æ–∏—Å–∫: –Ω–∞–∑–≤–∞–Ω–∏–µ / –∫–ª–∏–µ–Ω—Ç / –ø–ª–æ—â–∞–¥–∫–∞" />
          <select id="projectStage">
            <option value="">–í—Å–µ —ç—Ç–∞–ø—ã</option>
          </select>
          <button class="btn" id="projectRefresh">–û–±–Ω–æ–≤–∏—Ç—å</button>
        </div>
        <div class="tablewrap">
          <table class="table" id="projectsTable">
            <thead>
              <tr>
                <th>–ü—Ä–æ–µ–∫—Ç</th><th>–≠—Ç–∞–ø</th><th>–ü–µ—Ä–∏–æ–¥</th><th>–ì–æ—Ä–æ–¥</th><th>–ü–ª–æ—â–∞–¥–∫–∞</th><th class="right">‚Äî</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>

      <!-- Reservations -->
      <section class="card tabpane hidden" id="tab-reservations">
        <div class="row">
          <h2>–†–µ–∑–µ—Ä–≤—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</h2>
          <button class="btn btn-primary" id="reserveNewBtn">+ –†–µ–∑–µ—Ä–≤</button>
        </div>
        <div class="filters">
          <input id="resSearch" placeholder="–ü–æ–∏—Å–∫: –ø—Ä–æ–µ–∫—Ç / –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ" />
          <input id="resFrom" type="date" />
          <input id="resTo" type="date" />
          <button class="btn" id="resRefresh">–û–±–Ω–æ–≤–∏—Ç—å</button>
        </div>
        <div class="tablewrap">
          <table class="table" id="resTable">
            <thead>
              <tr>
                <th>–ü—Ä–æ–µ–∫—Ç</th><th>–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</th><th>–ö–æ–ª-–≤–æ</th><th>–ü–µ—Ä–∏–æ–¥</th><th class="right">‚Äî</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="muted small" style="margin-top:10px">
          ‚ö†Ô∏è –†–µ–∑–µ—Ä–≤ —Å–æ–∑–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ RPC —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (–ø–æ –¥–∞—Ç–∞–º). –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å—á–∏—Ç–∞—é—Ç—Å—è –≤ –±–∞–∑–µ.
        </div>
      </section>

      <!-- Equipment -->
      <section class="card tabpane hidden" id="tab-equipment">
        <div class="row">
          <h2>–°–∫–ª–∞–¥</h2>
          <button class="btn btn-primary" id="equipmentNewBtn">+ –ü–æ–∑–∏—Ü–∏—è</button>
        </div>
        <div class="filters">
          <input id="equipmentSearch" placeholder="–ü–æ–∏—Å–∫: –Ω–∞–∑–≤–∞–Ω–∏–µ / –∫–∞—Ç–µ–≥–æ—Ä–∏—è" />
          <button class="btn" id="equipmentRefresh">–û–±–Ω–æ–≤–∏—Ç—å</button>
        </div>
        <div class="tablewrap">
          <table class="table" id="equipmentTable">
            <thead>
              <tr>
                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th><th>–í—Å–µ–≥–æ</th><th class="right">‚Äî</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="muted small" style="margin-top:10px">
          –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ –¥–∞—Ç–∞–º —Å—á–∏—Ç–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É —Ä–µ–∑–µ—Ä–≤–æ–≤ (–∞ –Ω–µ —á–µ—Ä–µ–∑ "qty_available" –≤—Ä—É—á–Ω—É—é).
        </div>
      </section>

      <!-- Tasks -->
      <section class="card tabpane hidden" id="tab-tasks">
        <div class="row">
          <h2>–ó–∞–¥–∞—á–∏</h2>
          <button class="btn btn-primary" id="taskNewBtn">+ –ó–∞–¥–∞—á–∞</button>
        </div>
        <div class="filters">
          <select id="taskDone">
            <option value="0">–û—Ç–∫—Ä—ã—Ç—ã–µ</option>
            <option value="">–í—Å–µ</option>
            <option value="1">–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ</option>
          </select>
          <button class="btn" id="taskRefresh">–û–±–Ω–æ–≤–∏—Ç—å</button>
        </div>
        <div class="tablewrap">
          <table class="table" id="tasksTable">
            <thead>
              <tr>
                <th>–ó–∞–¥–∞—á–∞</th><th>–°—Ä–æ–∫</th><th>–ü—Ä–æ–µ–∫—Ç</th><th>–°—Ç–∞—Ç—É—Å</th><th class="right">‚Äî</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
    </section>

    <!-- Modal -->
    <div id="modal" class="modal hidden">
      <div class="modal-card">
        <div class="modal-head">
          <div id="modalTitle" class="modal-title">‚Äî</div>
          <button id="modalClose" class="btn btn-ghost">‚úï</button>
        </div>
        <form id="modalForm" class="form">
          <div id="modalBody"></div>
          <div class="row right">
            <button type="button" id="modalCancel" class="btn btn-ghost">–û—Ç–º–µ–Ω–∞</button>
            <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          </div>
          <div id="modalMsg" class="msg"></div>
        </form>
      </div>
    </div>

  </main>

  <footer class="footer muted small">
    üîí –¢–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ¬∑ üíæ Postgres ¬∑ üß† –†–µ–∑–µ—Ä–≤ –ø–æ –¥–∞—Ç–∞–º
  </footer>

  <script src="./app.js"></script>
</body>
</html>
